{"is_source_file": true, "format": "Python", "description": "This file defines a FastAPI application for managing a product inventory with CRUD operations, database initialization, and a total balance calculation endpoint.", "external_files": ["os", "typing", "fastapi", "fastapi.middleware.cors", "pydantic", "sqlite3", "contextlib", "uvicorn"], "external_methods": ["os.getenv", "os.path.dirname", "os.path.exists", "os.makedirs", "sqlite3.connect", "sqlite3.Row", "sqlite3.Cursor.execute", "sqlite3.Cursor.fetchone", "sqlite3.Cursor.fetchall", "sqlite3.Connection.commit", "sqlite3.Connection.close", "sqlite3.Connection.row_factory", "uvicorn.run"], "published": ["health_check", "list_products", "create_product", "get_product", "update_product", "delete_product", "get_products_balance"], "classes": [{"name": "ProductCreate", "description": "Input model for creating a product, includes validation and descriptive fields."}, {"name": "ProductUpdate", "description": "Input model for updating a product with optional fields and validation."}, {"name": "Product", "description": "Response model representing a product with id, name, price, and quantity."}], "methods": [{"name": "str _sqlite_path_from_url(url: str)", "description": "Converts a SQLite URL to a filesystem path.", "scope": "", "scopeKind": ""}, {"name": "get_db_cursor()", "description": "Provides a context-managed SQLite cursor with proper connection handling.", "scope": "", "scopeKind": ""}, {"name": "init_db()", "description": "Initializes the products table if it does not exist.", "scope": "", "scopeKind": ""}, {"name": "sqlite3.Row fetch_product_or_404(product_id: int)", "description": "Fetches a product by ID or raises 404 HTTPException if not found.", "scope": "", "scopeKind": ""}, {"name": "create_product(payload: ProductCreate)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "delete_product( id: int = Path(..., description=\"The ID of the product to delete\", ge=1), )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_product( id: int = Path(..., description=\"The ID of the product to retrieve\", ge=1) )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_products_balance()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "health_check()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list_products()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "on_startup()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "update_product( payload: ProductUpdate, id: int = Path(..., description=\"The ID of the product to update\", ge=1), )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "validate_price(cls, v)", "scope": "ProductUpdate", "scopeKind": "class", "description": "unavailable"}], "calls": ["os.getenv", "os.path.dirname", "os.path.exists", "os.makedirs", "sqlite3.connect", "conn.row_factory", "conn.cursor", "cur.execute", "cur.fetchone", "cur.fetchall", "conn.commit", "conn.close", "uvicorn.run"], "search-terms": ["product management", "FastAPI CRUD", "SQLite connection", "total inventory balance", "product API endpoints", "health check endpoint", "database initialization"], "state": 2, "file_id": 2, "knowledge_revision": 16, "git_revision": "fe12cd4f7423af6233b0baa02c0da9f430abd3f5", "revision_history": [{"9": "74da7c8b0005aacf27b604971f2cbcc1c01aac3e"}, {"10": "74da7c8b0005aacf27b604971f2cbcc1c01aac3e"}, {"14": "fe12cd4f7423af6233b0baa02c0da9f430abd3f5"}, {"15": "fe12cd4f7423af6233b0baa02c0da9f430abd3f5"}, {"16": "fe12cd4f7423af6233b0baa02c0da9f430abd3f5"}], "ctags": [{"_type": "tag", "name": "DB_FILE_PATH", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^DB_FILE_PATH = _sqlite_path_from_url(DEFAULT_DB_PATH)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "DEFAULT_DB_PATH", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^DEFAULT_DB_PATH = os.getenv(\"DATABASE_URL\", \"sqlite:\\/\\/\\/.\\/products.db\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "Product", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^class Product(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "ProductCreate", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^class ProductCreate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "ProductUpdate", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^class ProductUpdate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_sqlite_path_from_url", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^def _sqlite_path_from_url(url: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(url: str)"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "create_product", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^def create_product(payload: ProductCreate):$/", "language": "Python", "kind": "function", "signature": "(payload: ProductCreate)"}, {"_type": "tag", "name": "delete_product", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^def delete_product($/", "language": "Python", "kind": "function", "signature": "( id: int = Path(..., description=\"The ID of the product to delete\", ge=1), )"}, {"_type": "tag", "name": "fetch_product_or_404", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^def fetch_product_or_404(product_id: int) -> sqlite3.Row:$/", "language": "Python", "typeref": "typename:sqlite3.Row", "kind": "function", "signature": "(product_id: int)"}, {"_type": "tag", "name": "get_db_cursor", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^def get_db_cursor():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_product", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^def get_product($/", "language": "Python", "kind": "function", "signature": "( id: int = Path(..., description=\"The ID of the product to retrieve\", ge=1) )"}, {"_type": "tag", "name": "get_products_balance", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^def get_products_balance():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^def health_check():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    id: int = Field(..., description=\"Unique identifier of the product\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "Product", "scopeKind": "class"}, {"_type": "tag", "name": "init_db", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^def init_db():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "list_products", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^def list_products():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    name: Optional[str] = Field(None, description=\"Updated product name\", min_length=1, max_leng/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "ProductUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    name: str = Field(..., description=\"The product's name\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "Product", "scopeKind": "class"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    name: str = Field(..., description=\"The product's name\", min_length=1, max_length=255)$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "ProductCreate", "scopeKind": "class"}, {"_type": "tag", "name": "on_startup", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^def on_startup():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "port", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    port = int(os.getenv(\"PORT\", \"3001\"))$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "price", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    price: Optional[float] = Field(None, description=\"Updated price, must be non-negative\", ge=0/", "language": "Python", "typeref": "typename:Optional[float]", "kind": "variable", "scope": "ProductUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "price", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    price: float = Field(..., description=\"The product's price, must be non-negative\", ge=0)$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "ProductCreate", "scopeKind": "class"}, {"_type": "tag", "name": "price", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    price: float = Field(..., description=\"The product's price\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "Product", "scopeKind": "class"}, {"_type": "tag", "name": "quantity", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    quantity: Optional[int] = Field(None, description=\"Updated quantity, must be non-negative in/", "language": "Python", "typeref": "typename:Optional[int]", "kind": "variable", "scope": "ProductUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "quantity", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    quantity: int = Field(..., description=\"Available quantity, must be non-negative integer\", g/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "ProductCreate", "scopeKind": "class"}, {"_type": "tag", "name": "quantity", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    quantity: int = Field(..., description=\"Available quantity\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "Product", "scopeKind": "class"}, {"_type": "tag", "name": "update_product", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^def update_product($/", "language": "Python", "kind": "function", "signature": "( payload: ProductUpdate, id: int = Path(..., description=\"The ID of the product to update\", ge=1), )"}, {"_type": "tag", "name": "validate_price", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    def validate_price(cls, v):$/", "language": "Python", "kind": "member", "signature": "(cls, v)", "scope": "ProductCreate", "scopeKind": "class"}, {"_type": "tag", "name": "validate_price", "path": "/home/kavia/workspace/code-generation/product-management-api-34231-34258/products_api_backend/src/api/main.py", "pattern": "/^    def validate_price(cls, v):$/", "language": "Python", "kind": "member", "signature": "(cls, v)", "scope": "ProductUpdate", "scopeKind": "class"}], "hash": "4ec130a7c0e64de864e157bd477a3c42", "format-version": 4, "code-base-name": "products_api_backend", "filename": "products_api_backend/src/api/main.py", "fields": [{"name": "DB_FILE_PATH = _sqlite_path_from_url(DEFAULT_DB_PATH)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "DEFAULT_DB_PATH = os.getenv(\"DATABASE_URL\", \"sqlite:\\/\\/\\/.\\/products.db\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int id", "scope": "Product", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] name", "scope": "ProductUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "str name", "scope": "Product", "scopeKind": "class", "description": "unavailable"}, {"name": "port = int(os.getenv(\"PORT\", \"3001\"))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[float] price", "scope": "ProductUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "float price", "scope": "ProductCreate", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[int] quantity", "scope": "ProductUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "int quantity", "scope": "ProductCreate", "scopeKind": "class", "description": "unavailable"}]}